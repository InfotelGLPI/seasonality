/*! https://github.com/tamble/jquery-ui-daterangepicker
 * Copyright (c) 2015 Tamble, Inc. Licensed MIT
 */

(function(a,F,T){function P(c,b,e){function g(b){d.button("option","label",b)}var d,h;h="drp_autogen"+z++;a('label[for="'+c.attr("id")+'"]').attr("for",h);d=a('<button type="button"></button>').addClass(b+"-triggerbutton").attr({title:c.attr("title"),tabindex:c.attr("tabindex"),id:h}).button({icons:{secondary:e.icon},label:e.initialText});return{getElement:function(){return d},getLabel:function(){return d.button("option","label")},setLabel:g,reset:function(){c.val("").change();g(e.initialText)},enforceOptions:function(){d.button("option",
{icons:{secondary:e.icon},label:e.initialText})}}}function G(c,b,e){var g,d;(function(){g=a("<div></div>").addClass(c+"-presets");d=a("<ul></ul>");a.each(b.presetRanges,function(){a('<li><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).click(e).appendTo(d)});g.append(d);d.menu().data("ui-menu").delay=0})();return{getElement:function(){return g}}}function Q(c,b){function e(e,d){var c=a.datepicker.parseDate(b.datepickerOptions.dateFormat||a.datepicker._defaults.dateFormat,
e);!f.start||f.end?(f.start=c,f.end=null):c<f.start?(f.end=f.start,f.start=c):f.end=c;if(b.datepickerOptions.hasOwnProperty("onSelect"))b.datepickerOptions.onSelect(e,d)}function g(a){var e=[!0,f.start&&(+a===+f.start||f.end&&f.start<=a&&a<=f.end)?"ui-state-highlight":""],c=[!0,""];b.datepickerOptions.hasOwnProperty("beforeShowDay")&&(c=b.datepickerOptions.beforeShowDay(a));return[e[0]&&c[0],e[1]+" "+c[1]]}function d(){setTimeout(function(){h();d()},moment().endOf("day")-moment())}function h(){q.datepicker("refresh");
q.datepicker("setDate",null)}var q,f={start:null,end:null};q=a("<div></div>",{"class":c+"-calendar ui-widget-content"});q.datepicker(a.extend({},b.datepickerOptions,{beforeShowDay:g,onSelect:e}));d();return{getElement:function(){return q},scrollToRangeStart:function(){f.start&&q.datepicker("setDate",f.start)},getRange:function(){return f},setRange:function(b){f=b;h()},refresh:h,reset:function(){f={start:null,end:null};h()},enforceOptions:function(){q.datepicker("option",a.extend({},b.datepickerOptions,
{beforeShowDay:g,onSelect:e}))}}}function R(c,b,e){var g,d,h,q;d=a('<button type="button" class="ui-priority-primary"></button>').text(b.applyButtonText).button();h=a('<button type="button" class="ui-priority-secondary"></button>').text(b.clearButtonText).button();q=a('<button type="button" class="ui-priority-secondary"></button>').text(b.cancelButtonText).button();g=a("<div></div>").addClass(c+"-buttonpanel").append(d).append(h).append(q);e&&(d.click(e.onApply),h.click(e.onClear),q.click(e.onCancel));
return{getElement:function(){return g},enforceOptions:function(){d.button("option","label",b.applyButtonText);h.button("option","label",b.clearButtonText);q.button("option","label",b.cancelButtonText)}}}function S(c,b){function e(){if(b.autoFitCalendars){var k=a(F).width(),l=p.outerWidth(!0),c=r.getElement(),d=c.datepicker("option","numberOfMonths"),f=d;if(l>k){for(;1<d&&p.outerWidth(!0)>k;)c.datepicker("option","numberOfMonths",--d);d!==f&&(e.monthWidth=(l-p.outerWidth(!0))/(f-d))}else for(;d<e.numberOfMonths&&
k-p.outerWidth(!0)>=e.monthWidth;)c.datepicker("option","numberOfMonths",++d);I();C=!1}}function g(){m.getElement().click(J);m.getElement().keydown(z);x.click(s);a(F).resize(function(){t?e():C=!0})}function d(k){var l=b.dateFormat;return a.datepicker.formatDate(l,k.start)+(+k.end!==+k.start?b.rangeSplitter+a.datepicker.formatDate(l,k.end):"")}function h(k){var l=b.altFormat,c={};c.start=a.datepicker.formatDate(l,k.start);c.end=a.datepicker.formatDate(l,k.end);return JSON.stringify(c)}function q(k){var c=
b.altFormat,d=null;if(k)try{d=JSON.parse(k,function(b,k){return b?a.datepicker.parseDate(c,k):k})}catch(e){}return d}function f(){var b=B();b?(m.setLabel(d(b)),r.setRange(b)):r.reset()}function A(a){var l=a||r.getRange();if(l.start&&(l.end||(l.end=l.start),a&&r.setRange(l),m.setLabel(d(l)),c.val(h(l)).change(),b.onChange))b.onChange()}function B(){return q(c.val())}function H(){m.reset();r.reset();c.val("")}function K(){var c=a(this),d=c.data("dateStart")().startOf("day").toDate(),c=c.data("dateEnd")().startOf("day").toDate();
r.setRange({start:d,end:c});b.applyOnMenuSelect&&(s(),A());return!1}function I(){p.position({my:"left top",at:"left bottom"+(0>b.verticalOffset?b.verticalOffset:"+"+b.verticalOffset),of:m.getElement(),collision:"flipfit flipfit",using:function(c,a){var d=u,e,f=a.element.top+a.element.height/2,h=a.target.top+a.target.height/2,g=v;u=a.element.left+a.element.width/2>a.target.left+a.target.width/2?L:M;u!==d&&(b.mirrorOnCollision&&(e=u===M?w:r,p.children().first().append(e.getElement())),p.removeClass(n+
"-"+y[d]),p.addClass(n+"-"+y[u]));p.css({left:c.left,top:c.top});v=f>h?N:O;v!==g&&(null!==g&&m.getElement().removeClass(n+"-"+y[g]),m.getElement().addClass(n+"-"+y[v]));d=v===N&&a.element.top-a.target.top!==a.target.height+b.verticalOffset||v===O&&a.target.top-a.element.top!==a.element.height+b.verticalOffset;m.getElement().toggleClass(n+"-vfit",d)}})}function z(b){switch(b.which){case a.ui.keyCode.UP:case a.ui.keyCode.DOWN:b.preventDefault();b.stopPropagation();D();break;case a.ui.keyCode.ESCAPE:b.preventDefault();
b.stopPropagation();s();break;case a.ui.keyCode.TAB:s()}}function D(){t||(m.getElement().addClass(n+"-active"),x.show(),t=!0,C&&e(),r.scrollToRangeStart(),p.show(),I());if(b.onOpen)b.onOpen()}function s(){t&&(p.hide(),x.hide(),m.getElement().removeClass(n+"-active"),t=!1);if(b.onClose)b.onClose()}function J(){t?s():D()}var n="comiseo-daterangepicker",p,x,m,w,r,E,t=!1,C=!1,M=0,L=1,O=2,N=3,y=["left","right","top","bottom"],u=L,v=null;(function(){m=P(c,n,b);w=G(n,b,K);r=Q(n,b);e.numberOfMonths=b.datepickerOptions.numberOfMonths;
e.numberOfMonths instanceof Array&&(b.autoFitCalendars=!1);E=R(n,b,{onApply:function(){s();A()},onClear:function(){s();H()},onCancel:function(){s();f()}});p=a("<div></div>",{"class":n+" "+n+"-"+y[u]+" ui-widget ui-widget-content ui-corner-all ui-front"}).append(a("<div></div>",{"class":n+"-main ui-widget-content"}).append(w.getElement()).append(r.getElement())).append(a('<div class="ui-helper-clearfix"></div>').append(E.getElement())).hide();c.hide().after(m.getElement());x=a("<div></div>",{"class":"ui-front "+
n+"-mask"}).hide();a("body").append(x).append(p);e();f();g()})();return{toggle:J,destroy:function(){p.remove();m.getElement().remove();c.show()},open:D,close:s,setRange:A,getRange:B,clearRange:H,reset:f,enforceOptions:function(){var a=w;w=G(n,b,K);a.getElement().replaceWith(w.getElement());r.enforceOptions();E.enforceOptions();m.enforceOptions();(a=B())&&m.setLabel(d(a))},getContainer:function(){return p}}}var z=0;a.widget("comiseo.daterangepicker",{version:"0.4.1",options:{presetRanges:[{text:"Today",
dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Yesterday",dateStart:function(){return moment().subtract("days",1)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Last 7 Days",dateStart:function(){return moment().subtract("days",6)},dateEnd:function(){return moment()}},{text:"Last Week (Mo-Su)",dateStart:function(){return moment().subtract("days",7).isoWeekday(1)},dateEnd:function(){return moment().subtract("days",7).isoWeekday(7)}},{text:"Month to Date",
dateStart:function(){return moment().startOf("month")},dateEnd:function(){return moment()}},{text:"Previous Month",dateStart:function(){return moment().subtract("month",1).startOf("month")},dateEnd:function(){return moment().subtract("month",1).endOf("month")}},{text:"Year to Date",dateStart:function(){return moment().startOf("year")},dateEnd:function(){return moment()}}],verticalOffset:0,initialText:"Select date range...",icon:"ui-icon-triangle-1-s",applyButtonText:"Apply",clearButtonText:"Clear",
cancelButtonText:"Cancel",rangeSplitter:" - ",dateFormat:"M d, yy",altFormat:"yy-mm-dd",mirrorOnCollision:!0,applyOnMenuSelect:!0,autoFitCalendars:!0,onOpen:null,onClose:null,onChange:null,datepickerOptions:{numberOfMonths:3,maxDate:0}},_create:function(){this._dateRangePicker=S(this.element,this.options)},_destroy:function(){this._dateRangePicker.destroy()},_setOptions:function(a){this._super(a);this._dateRangePicker.enforceOptions()},open:function(){this._dateRangePicker.open()},close:function(){this._dateRangePicker.close()},
setRange:function(a){this._dateRangePicker.setRange(a)},getRange:function(){return this._dateRangePicker.getRange()},clearRange:function(){this._dateRangePicker.clearRange()},widget:function(){return this._dateRangePicker.getContainer()}})})(jQuery,window);
